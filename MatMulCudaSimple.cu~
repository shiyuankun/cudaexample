#include <stdio.h>
#include "matrix.h"

__global__ void
MatrixMulOnDevice(const Matrix M, const Matrix N, Matrix P)
{
    
    int tx = threadIdx.x;
    int ty = threadIdx.y;
    float Pvalue = 0;
    for (int k = 0;k<M->width; ++ k)
    {
        float Melement = M.elements[ty * M.width + k];
        float Nelement = N.elements[k * N.width + tx];
        Pvalue += Melement * Nelement;
    }
    P.elements[ty * P.pitch + tx] = Pvalue;
}
